import subprocess import random import re #===================================================================================== def get_interfaces(): # Get the list of network interfaces result = subprocess.run(["ip", "link", "show"], capture_output=True, text=True) interfaces = [] for line in result.stdout.split('\n'): if ':' in line: parts = line.split(':') if len(parts) > 1: interface = parts[1].strip() if interface and interface != 'lo': # Skip the loopback interface interfaces.append(interface) return interfaces #===================================================================================== def get_current_mac(interface): # Get the current MAC address of the specified interface result = subprocess.run(["ip", "link", "show", interface], capture_output=True, text=True) match = re.search(r"link/ether ([0-9a-f:]{17})", result.stdout) if match: return match.group(1) else: return None #===================================================================================== def generate_random_mac(): # Generate a random MAC address mac = [0x00, 0x16, 0x3
